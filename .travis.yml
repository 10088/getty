language: go

go:
  - "1.13"

env:
  - GO111MODULE=on

script:
  - go fmt ./... && [[ -z `git status -s` ]]
  - go mod vendor && cd transport && go test -v options_test.go client_test.go server_test.go session.go client.go connection.go const.go getty.go server.go options.go
  - cd ../rpc && go test -v config_test.go rpc_test.go server_test.go client_test.go server.go client.go listener.go rpc.go codec.go config.go readwriter.go util.go pool.go rpcclientmap.go codec.pb.go
  - cd ../micro && go test -v client_test.go server_test.go server.go client.go config.go

after_success:
  - bash <(curl -s https://codecov.io/bash)

notifications:
  webhooks: https://oapi.dingtalk.com/robot/send?access_token=75f4f1ec3868508aa89e5a5d6f9d342216809df3ebc8a78c8ae8722848e06166
  webhooks: https://oapi.dingtalk.com/robot/send?access_token=072b74afbf3e746adeac1edecd5823cd24625a97eac42862476046e3057fb5ab